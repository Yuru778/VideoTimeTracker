# VideoTimeTracker 瀏覽器擴充功能開發計畫

## 1. 專案概述
本專案旨在開發一個基於 Chromium 內核 (Brave, Chrome, Edge) 的瀏覽器擴充功能，專門用於追蹤 `https://www.skills.google/` 網站的學習時間。

### 主要目標
*   **精確監測**：區分影片播放時間、使用者互動時間與網頁掛機時間。
*   **數據同步**：利用瀏覽器帳號進行跨裝置進度同步。
*   **無感運行**：不干擾正常學習，不觸發反爬蟲機制。

## 2. 技術架構

*   **核心標準**: Manifest V3 (最新瀏覽器擴充標準)。
*   **語言**: HTML, CSS, Vanilla JavaScript (輕量化，無須編譯)。
*   **儲存與同步**: `chrome.storage.local` (本機備份) + `chrome.storage.sync` (跨裝置雲端同步)。
*   **目標網站**: `https://www.skills.google/*`

## 3. 功能詳細設計

### A. 時間追蹤邏輯 (Content Script)
監控腳本將注入到目標網頁，維護三個計時器：

1.  **影片播放時間 (Video Playback Time)**
    *   **判定標準**：網頁中存在 `<video>` 元素 且 `video.paused === false` 且 `video.ended === false`。
    *   **機制**：監聽 `play`, `pause`, `waiting` 事件，確保只有畫面在動時才計時。

2.  **互動時間 (Interaction Time)**
    *   **判定標準**：滿足以下 **任一** 條件即視為互動：
        *   影片正在播放中 (視為專注觀看)。
        *   影片暫停，但在過去 **30秒** 內偵測到滑鼠移動、點擊、滾動或鍵盤按壓 (視為閱讀教材或做題)。
    *   **機制**：使用 Debounce 技術監聽 DOM 事件，避免效能消耗。

3.  **總掛機時間 (Total Duration)**
    *   **判定標準**：分頁處於開啟狀態的總時間 (包含暫停且無互動的時間)。

### B. 數據同步機制 (Sync)
*   **利用 `chrome.storage.sync`**：
    *   **Chrome**: 自動透過您登入瀏覽器的 Google 帳號同步到其他 Chrome 裝置。
    *   **Edge**: 自動透過 Microsoft 帳號同步到其他 Edge 裝置。
    *   **Brave**: 透過 Brave Sync Chain 同步。
    *   *注意：不同品牌的瀏覽器之間 (如 Chrome 到 Edge) 無法直接互通，需依賴相同瀏覽器生態。*
*   **儲存結構**：以「日期」為 Key 儲存數據，例如：
    ```json
    "2023-10-27": {
        "videoTime": 3600,      // 秒
        "interactionTime": 4200, // 秒
        "totalTime": 5000       // 秒
    }
    ```

### C. 使用者介面 (Popup)
點擊瀏覽器右上角圖示顯示：
*   今日數據面板 (影片/互動/總時數)。
*   最近 7 天的歷史紀錄圖表或列表 (選用)。
*   同步狀態指示燈 (顯示「已同步」或「上次更新時間」)。

## 4. 安全性與隱私
*   **權限最小化**：Manifest 中僅宣告 `storage` 權限以及對 `https://www.skills.google/` 的存取權。
*   **被動偵測**：完全不主動發送 HTTP 請求，僅被動監聽 DOM 事件，對於 Google 伺服器來說，此擴充功能是透明的，無被封號風險。

## 5. 檔案結構規劃

```text
D:\TASTUFF\VideoTimeTracker\
├── manifest.json       # 設定檔 (定義權限、目標網站)
├── popup.html          # 彈出視窗介面
├── popup.js            # 彈出視窗邏輯 (讀取數據、顯示)
├── popup.css           # 介面樣式
├── content.js          # 注入網頁的監控腳本 (核心邏輯)
├── background.js       # 背景服務 (處理初始化或特定事件)
└── icons/              # 圖示檔案
    ├── icon16.png
    ├── icon48.png
    └── icon128.png
```

## 6. 下一步驟
1.  建立專案檔案結構。
2.  撰寫 `manifest.json` 與 `content.js` (核心演算法)。
3.  撰寫 UI 並整合同步功能。
4.  提供「載入未封裝擴充功能」的圖文指引。
